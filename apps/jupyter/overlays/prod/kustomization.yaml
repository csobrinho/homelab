apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - ../../base
  - ingress-route.yaml

helmCharts:
  - name: jupyterhub
    repo: https://hub.jupyter.org/helm-chart/
    releaseName: jupyter
    namespace: jupyter
    version: 3.3.8
    includeCRDs: true
    valuesInline:
      hub:
        extraEnv:
          TZ: America/Los_Angeles
        db:
          pvc:
            storageClassName: "longhorn-retain"
        config:
          Authenticator:
            admin_users:
              - admin
            allowed_users:
              - sobrinho
          DummyAuthenticator:
            password: admin
          JupyterHub:
            authenticator_class: dummy
        extraConfig:
          ignoreXHRToken.py: |
            c.IdentityProvider.token = ''
      proxy:
        service:
          type: ClusterIP
      singleuser:
        storage:
          dynamic:
            storageClass: "longhorn-retain"
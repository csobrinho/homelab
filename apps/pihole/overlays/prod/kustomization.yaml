apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - ../../base
  - dashboard-prefix.yaml
  - dashboard-redirect.yaml
  - ingress-route.yaml

helmCharts:
  - name: pihole
    repo: https://mojo2600.github.io/pihole-kubernetes/
    releaseName: pihole
    namespace: pihole
    version: 2.26.1
    includeCRDs: true
    valuesInline:
      hostname: "pihole"
      hostNetwork: true
      DNS1: 10.10.1.1
      DNS2: ""
      extraEnvVars:
        - name: TZ
          value: America/Los_Angeles
      persistentVolumeClaim:
        enabled: true
        storageClass: longhorn
      serviceWeb:
        annotations:
      serviceDns:
        annotations:
          metallb.universe.tf/allow-shared-ip: infra-dns
          metallb.universe.tf/loadBalancerIPs: 10.10.1.9
        type: LoadBalancer
        externalTrafficPolicy: Cluster
      serviceDhcp:
        enabled: false
      podDnsConfig:
        enabled: true
        policy: None
        nameservers:
          - 127.0.0.1
          - 1.1.1.1
